"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[9371,376],{50376:(e,t,n)=>{n.r(t),n.d(t,{DeleteConvo:()=>u,ReadConvo:()=>s,SendMessage:()=>c});var r=n(21447);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}var c=function(e){return function(){var t,n=(t=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.Z.send("SendMessage",e);case 3:return t.next=5,t.sent.json();case 5:if(null==t.sent){t.next=11;break}return n({type:"ADD_DATA",payload:{type:"messages",first:!0,data:a({},e)}}),t.abrupt("return",!0);case 11:return t.abrupt("return",!1);case 12:t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}()},s=function(e,t){return function(n){r.Z.send("ReadConvo",e).then((function(){n({type:"SET_DATA",payload:{type:"messages",data:t.map((function(t){return a(a({},t),{},{unread:t.number!==e&&t.unread})}))}})})).catch((function(e){}))}},u=function(e,t,n){return function(t){r.Z.send("DeleteConvo",e).then((function(){return t({type:"SET_DATA",payload:{type:"messages",data:n.filter((function(t){return t.number!=e}))}}),!0})).catch((function(e){return!1}))}}},9371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var r=n(89526),o=n(92070),a=n(65092),i=n(88590),l=n(14710),c=n(32165),s=n(16025),u=n(22993),p=n(2029),m=n(72757),f=n(23646),d=n(71529),h=n(57170),b=n(55565),g=n(23192),v=n(59324),y=n.n(v),x=n(565),k=n(50376),w=n(87961),C=n(21447);function E(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=n(95028);const D=(0,o.$j)(null,{SendMessage:k.SendMessage,DeleteConvo:k.DeleteConvo,ReadConvo:k.ReadConvo})((function(e){var t=(0,w.VY)(),n=(0,a.k6)(),v=e.match.params.number,k=(0,o.v9)((function(e){return e.data.data.contacts})).filter((function(e){return e.number===v}))[0],S=(0,o.v9)((function(e){return e.data.data.messages})),D=(0,o.v9)((function(e){return e.data.data.player})),P=(0,o.v9)((function(e){return e.call.call})),T=Z((0,r.useState)([]),2),N=T[0],O=T[1];(0,r.useEffect)((function(){O(S.filter((function(e){return e.number===v})).sort((function(e,t){return t.time-e.time}))),S.filter((function(e){return e.number===v&&e.unread})).length>0&&e.ReadConvo(v,S)}),[S]);var j=(0,d.Z)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main,overflow:"hidden"},header:{background:null!=k?k.color:e.palette.primary.main,fontSize:20,padding:15,lineHeight:"45px"},avatar:{color:"#fff",height:45,width:45},avatarFav:{color:"#fff",height:45,width:45,border:"2px solid gold"},messageAction:{textAlign:"center","&:hover":{color:e.palette.text.main,transition:"color ease-in 0.15s"}},body:{padding:10,height:"75%",display:"flex",flexDirection:"column-reverse",overflowX:"hidden",overflowY:"auto","&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-thumb":{background:"#ffffff52"},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.primary.main},"&::-webkit-scrollbar-track":{background:"transparent"}},input:{width:"100%",padding:"0 10px"},textInput:{width:"100%",marginTop:"0 !important"},submitBtn:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)","&:hover":{borderBottom:"2px solid #fff",color:e.palette.primary.main,transition:"color, border-bottom ease-in 0.15s"}},submitBtnDisabled:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)",filter:"brightness(0.25)"},submitIcon:{display:"block",margin:"auto",height:"100%",width:"40%"},textWrap:{width:"100%",fontSize:16,margin:"20px 0px",padding:"0 10px",color:e.palette.text.light,"&:first-of-type":{marginTop:0}},myText:{marginLeft:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:e.palette.secondary.dark,overflowWrap:"break-word",hyphens:"auto"},otherText:{marginRight:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:null!=k?k.color:e.palette.primary.main,overflowWrap:"break-word",hyphens:"auto"},timestamp:{color:e.palette.text.main,fontSize:12,padding:"5px 5px 0px 5px"},messageImg:{display:"block",maxWidth:200},copyableText:{color:e.palette.primary.main,textDecoration:"underline","&:hover":{transition:"color ease-in 0.15s",color:e.palette.text.main,cursor:"pointer"}}}}))(),I=Z((0,r.useState)(!1),2),R=I[0],z=I[1],B=Z((0,r.useState)(""),2),M=B[0],$=B[1],W=Z((0,r.useState)({left:110,top:0}),2),Y=W[0],_=W[1],F=function(){z(!1)},U=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=P){e.next=14;break}return e.prev=1,e.next=4,C.Z.send("CreateCall",{number:v,isAnon:!1});case 4:return e.next=6,e.sent.json();case 6:e.sent?n.push("/apps/phone/call/".concat(v)):t("Unable To Start Call"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),t("Unable To Start Call");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){E(a,r,o,i,l,"next",e)}function l(e){E(a,r,o,i,l,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}(),L=[{regex:/^https?:\/\/(\w+\.)?imgur.com\/(\w*\d\w*)+(\.[a-zA-Z]{3})?$/gim,fn:function(e,n){return r.createElement(b.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},r.createElement("img",{key:e,className:j.messageImg,src:n[0]}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)(mp4)/gim,fn:function(e,t){return r.createElement("div",null,r.createElement(g.Z,{key:e,volume:.25,width:"100%",controls:!0,url:"".concat(t[0])}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,n){return r.createElement(b.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},r.createElement("a",{className:j.copyableText},n.input))}},{regex:/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,n){return r.createElement(b.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},r.createElement("a",{className:j.copyableText},n.input))}},{regex:/ircinvite=(\d)+/gim,fn:function(e,t){return r.createElement(x.rU,{key:e,className:j.copyableText,to:"/apps/irc/join/".concat(t[0].split("=")[1])},"IRC Invite: ",t[0].split("=")[1])}}];return r.createElement("div",{className:j.wrapper},r.createElement(i.Z,{position:"static",className:j.header},r.createElement(l.ZP,{container:!0},r.createElement(l.ZP,{item:!0,xs:2},null!=k?null!=k.avatar&&""!==k.avatar?r.createElement(c.Z,{className:k.favorite?j.avatarFav:j.avatar,src:k.avatar,alt:k.name.charAt(0)}):r.createElement(c.Z,{className:k.favorite?j.avatarFav:j.avatar,style:{background:k.color}},k.name.charAt(0)):r.createElement(c.Z,{className:j.avatar},"#")),r.createElement(l.ZP,{item:!0,xs:6},null!=k?k.name:v),r.createElement(l.ZP,{item:!0,xs:4},r.createElement(l.ZP,{container:!0},r.createElement(l.ZP,{item:!0,xs:6,className:j.messageAction},r.createElement(s.Z,{onClick:U},r.createElement(h.G,{icon:"phone"}))),r.createElement(l.ZP,{item:!0,xs:6,className:j.messageAction},r.createElement(s.Z,{onClick:function(e){e.preventDefault(),_({left:e.clientX-2,top:e.clientY-4}),z(!0)}},r.createElement(h.G,{icon:"ellipsis-vertical"})))))),r.createElement(u.Z,{anchorReference:"anchorPosition",anchorPosition:Y,keepMounted:!0,open:R,onClose:F},r.createElement(p.Z,{onClick:function(){null!=k?n.push("/apps/contacts/edit/".concat(k._id)):n.push("/apps/contacts/add/".concat(v))}},null!=k?"View Contact":"Create Contact"),r.createElement(p.Z,{onClick:function(){e.DeleteConvo(v,D.Phone,S)?(t("Conversation Deleted"),n.goBack()):t("Unable To Delete Conversation"),F()}},"Delete Conversation"))),r.createElement("div",{className:j.body},N.map((function(e,t){return r.createElement("div",{key:t,className:j.textWrap},r.createElement(m.Z,{className:1===e.method?j.myText:j.otherText},A(L)(e.message)),r.createElement("div",{className:j.timestamp,style:{textAlign:1===e.method?"right":"left"}},r.createElement(y(),{titleFormat:"M/D/YYYY h:mm:ss A",withTitle:!0,fromNow:!0},+e.time)))}))),r.createElement("div",{className:j.input},r.createElement(l.ZP,{container:!0},r.createElement(l.ZP,{item:!0,xs:10},r.createElement(f.Z,{variant:"standard",className:j.textInput,label:"Send New Message",multiline:!0,rows:"4",value:M,onChange:function(e){$(e.target.value)}})),r.createElement(l.ZP,{item:!0,xs:2},r.createElement("div",{className:""!==M?j.submitBtn:j.submitBtnDisabled,onClick:function(t){t.preventDefault(),""!==M&&(e.SendMessage({owner:D.Phone,number:v,method:1,time:Date.now(),message:M}),$(""))}},r.createElement(h.G,{icon:"paper-plane",className:j.submitIcon}))))))}))},88590:(e,t,n)=>{n.d(t,{Z:()=>g});var r=n(71972),o=n(17692),a=n(89526),i=n(23060),l=n(82082),c=n(47671),s=n(26966),u=n(9333),p=n(72757),m=n(24989);function f(e){return(0,m.Z)("MuiAppBar",e)}(0,n(36787).Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var d=n(67557);const h=["className","color","enableColorOnDark","position"],b=(0,c.ZP)(p.Z,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${(0,u.Z)(n.position)}`],t[`color${(0,u.Z)(n.color)}`]]}})((({theme:e,ownerState:t})=>{const n="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,o.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===t.position&&{position:"fixed",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===t.position&&{position:"absolute",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"sticky"===t.position&&{position:"sticky",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"static"===t.position&&{position:"static"},"relative"===t.position&&{position:"relative"},"default"===t.color&&{backgroundColor:n,color:e.palette.getContrastText(n)},t.color&&"default"!==t.color&&"inherit"!==t.color&&"transparent"!==t.color&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},"inherit"===t.color&&{color:"inherit"},"dark"===e.palette.mode&&!t.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===t.color&&(0,o.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"}))})),g=a.forwardRef((function(e,t){const n=(0,s.Z)({props:e,name:"MuiAppBar"}),{className:a,color:c="primary",enableColorOnDark:p=!1,position:m="fixed"}=n,g=(0,r.Z)(n,h),v=(0,o.Z)({},n,{color:c,position:m,enableColorOnDark:p}),y=(e=>{const{color:t,position:n,classes:r}=e,o={root:["root",`color${(0,u.Z)(t)}`,`position${(0,u.Z)(n)}`]};return(0,l.Z)(o,f,r)})(v);return(0,d.jsx)(b,(0,o.Z)({square:!0,component:"header",ownerState:v,elevation:4,className:(0,i.Z)(y.root,a,"fixed"===m&&"mui-fixed"),ref:t},g))}))},95028:e=>{e.exports=function(e){var t=0;function n(e,r){if(!e.fn||"function"!=typeof e.fn)return r;if(!(e.regex&&e.regex instanceof RegExp))return r;if("string"==typeof r){for(var o=e.regex,a=null,i=[];null!==(a=o.exec(r));){var l=a.index,c=a[0];i.push(r.substring(0,l)),i.push(e.fn(++t,a)),r=r.substring(l+c.length,r.length+1),o.lastIndex=0}return i.push(r),i}return Array.isArray(r)?r.map((function(t){return n(e,t)})):r}return function(t){return e&&Array.isArray(e)&&e.length?(e.forEach((function(e){return t=n(e,t)})),t):t}}}}]);